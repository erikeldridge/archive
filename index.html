<button>click</button>
<script src="http://yui.yahooapis.com/3.1.0/build/yui/yui-min.js"></script>
<script>
//credit: http://javascript.crockford.com/remedial.html
if(!String.prototype.supplant){String.prototype.supplant=function(o){return this.replace(/{([^{}]*)}/g,function(a,b){var r=o[b];return typeof r==='string'||typeof r==='number'?r:a;});};}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");};}

var key = 'dj0yJmk9TDNTVXpvRnpsbjJHJmQ9WVdrOVpXRlBkWEJETm1zbWNHbzlNQS0tJnM9Y29uc3VtZXJzZWNyZXQmeD0wYw--';
var id = 'yahoo.com';
var uri = 'http://test.erikeldridge.com/connect/_openid_start.php?id={id}&key={key}&return_to={returnTo}'.supplant({
	id: id,
	key: key,
	returnTo: encodeURIComponent( 'http://test.erikeldridge.com/connect/relay.html' )
});

YUI().use('node', 'event-custom', function(Y) {
    Y.one('button').on( 'click', function(e){
    	var popup = window.open( uri,

    	    //pass key & id to relay.html thru window.name
    	    'key='+key+'&id='+id,

    	    'toolbar=0,scrollbars=1,location=1,statusbar=1,menubar=0,resizable=1,width=500,height=500,left=200,top=200'
    	);
        var interval = setInterval( function(){
            
            //poll popup for token definition
            try {
                if ( popup.token ) {
                    Y.log( popup.token );
                    clearInterval( interval );
                }
                if ( popup.closed ) {
                    clearInterval( interval );
                }
            } catch ( e ) {}
            
        }, 1000 );
    })

});
</script>